<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
        html,
        body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #map_container {
            width: 100%;
            height: 100%;
            margin: 0;
        }
    </style>
    <script type="text/javascript"
        src="https://api.map.baidu.com/api?type=webgl&v=1.0&ak=G1LFyjrNGIkns5OfpZnrCGAKxpycPLwb"></script>
    <script src="https://mapv.baidu.com/gl/examples/static/common.js"></script>
    <script src="https://mapv.baidu.com/build/mapv.js"></script>
    <script src="https://code.bdstatic.com/npm/mapvgl@1.0.0-beta.54/dist/mapvgl.min.js"></script>
    <script src="https://code.bdstatic.com/npm/mapvgl@1.0.0-beta.119/dist/mapvgl.threelayers.min.js"></script>
    <title>地图展示</title>
</head>

<body>
    <div id="map_container"></div>
    <script type="text/javascript">
        // http://lbsyun.baidu.com/solutions/mapvdata
        // 初始化地图
        var map = initMap({
            tilt: 0,
            heading: 0,
            center: [121.48169, 31.235188],
            zoom: 8,
            style: purpleStyle,

        });
        setData(initData());
        // 准备数据源
        function initData() {
            var data = [];
            // 飞线动画需要一个起点的坐标和一个终点的坐标
            // 贝塞尔曲线
            // 生成贝塞尔曲线坐标集
            // 1. 实例化贝塞尔曲线对象
            var curve = new mapvgl.BezierCurve();
            // 2. 设置起点和终点坐标
            var start = mapv.utilCityCenter.getCenterByCityName('上海')
            var end = mapv.utilCityCenter.getCenterByCityName('北京')
            curve.setOptions({
                start: [start.lng, start.lat],
                end: [end.lng, end.lat]
            })
            // 3. 生成贝塞尔曲线坐标集
            const curveModelData = curve.getPoints()
            data.push({
                geometry: {
                    type: 'LineString',
                    coordinates: curveModelData
                },
                properties: {
                    count: Math.random()
                }
            });

            return data;
        }

        // 绘制数据源
        function setData(data) {
            // 1. 初始化图层
            var view = new mapvgl.View({ map })

            // 2. 初始化飞线对象
            var flyLine = new mapvgl.FlyLineLayer({
                color: 'rgba(50, 50, 200, 1)',
                textureColor: 'rgba(50, 50, 200, 1)',
                textureWidth: 20, // 调整飞线的宽度
                textureLength: 30,
            })


            // 3. 将飞线对象添加到图层中 
            view.addLayer(flyLine)

            // 4. 将飞线对象与数据源进行绑定
            flyLine.setData(data)
        }
    </script>
</body>

</html>