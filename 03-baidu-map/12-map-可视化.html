<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- 引用百度地图的库 -->
    <script src="https://api.map.baidu.com/api?type=webgl&v=1.0&ak=MBABYv1BzdKnzAsynglfLpfDuhCUH3Wv"></script>
    <!-- 官方提供了一些通用的方法，可以让我们快速开发和地图初始化 -->
    <script src="https://mapv.baidu.com/gl/examples/static/common.js"></script>
    <!-- 引用mapv -->
    <script src="https://mapv.baidu.com/build/mapv.js"></script>
    <!-- 引入mapvgl 库 进行绘点 -->
    <script src="https://code.bdstatic.com/npm/mapvgl@1.0.0-beta.54/dist/mapvgl.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        html,
        body,
        #allmap,
        #map_container {
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
    <div id="map_container"></div>
    <!-- 
        官方地址： http://lbsyun.baidu.com/solutions/mapvdata
        mapv的gallery: 
            https://mapv.baidu.com/gallery.html
     -->


    <script>
        // 以前我们手动写的代码
        // var map = new BMapGL.Map('map_container');
        // var point = new BMapGL.Point(121.462143, 31.224319);
        // map.centerAndZoom('徐州市鼓楼区', 20);
        // map.enableScrollWheelZoom(true);

        // 现在我们用了百度地图提供的commonjs后。
        var cities = ['上海市']
        var cityCenter = mapv.utilCityCenter.getCenterByCityName(cities[0])
        console.log(cityCenter);
        // 要将id改为map_container
        var map = initMap({
            center: [cityCenter.lng, cityCenter.lat],
            zoom: 15,
            style: snowStyle,
            tilt: 0
        })

        // 绘制散点/飞线动画/3d动画等等。
        // 1. 准备数据源
        // 通过城市名获取百度地图的坐标
        // var cities = ['上海市']
        // var cityCenter = mapv.utilCityCenter.getCenterByCityName(cities[0])
        // console.log(cityCenter);
        var data = []
        data.push({
            // 地理位置
            geometry: {
                type: 'Point', // 代表一个点
                // 坐标
                coordinates: [cityCenter.lng, cityCenter.lat]
            },
            properties: {
                count: Math.random() * 100
            }
        })
        // 2. 绘制数据源
        // 1. 生成mapvgl视图view (类似于一层蒙层)
        var view = new mapvgl.View({ map })
        // 2. 初始化mapvgl 的 PointLayer 对象
        var pointLayer = new mapvgl.PointLayer({})
        // 3. 将pointLayer对象加入view 中。
        view.addLayer(pointLayer)
        // 4. 将data 和 PointLayer 进行绑定
        pointLayer.setData(data)
    </script>
</body>

</html>