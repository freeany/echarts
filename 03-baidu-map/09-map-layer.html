<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
        body,
        html,
        #allmap {
            width: 100%;
            height: 100%;
            overflow: hidden;
            margin: 0;
            font-family: "微软雅黑";
        }
    </style>
    <title>地图展示</title>
</head>

<body>
    <div id="allmap"></div>
</body>
<script type="text/javascript">
    function init() {
        var map = new BMapGL.Map('allmap');
        var point = new BMapGL.Point(116.404, 39.915);
        map.centerAndZoom(point, 15);
        map.enableScrollWheelZoom(true);
        map.setMapStyleV2({
            styleId: '316af4430dbc638850deb9b791f6a1d5'
        })

        // 在地图上绘制图标
        // 1. 定义一个icon对象, 第一个是图标的地址， 第二个是图标的尺寸， 第三个图标是options配置项
        // http://lbsyun.baidu.com/cms/jsapi/reference/jsapi_webgl_1_0.html#a3b4
        var myIcon = new BMapGL.Icon(
            "https://www.youbaobao.xyz/datav-res/datav/location.png",
            new BMapGL.Size(60, 60),
            {
                anchor: new BMapGL.Size(170, 30),// 左 上
                mageOffset: new BMapGL.Size(0, 0) // background-position
            }
        )
        // Marker标注代表地图上的一个图像标注
        var marker = new BMapGL.Marker(point, { icon: myIcon });
        // 给marker注册事件
        marker.addEventListener('click', function () {
            // alert('click事件 is start ')
            var content = '<div style="color: red">baidu-map</div><div style="color: green"> 可视化 </div>'
            // 点击之后打开一个弹窗
            var infoWindow = new BMapGL.InfoWindow(
                // '学习可视化', // 可以传入string
                content, // 可以传入一个字符串形式的dom对象
                {
                    width: 250,
                    height: 100,
                    title: '说明',
                    offset: new BMapGL.Size(-130, -10)
                }
            )
            map.openInfoWindow(infoWindow, point)
        })
        // 将marker对象添加到地图上
        map.addOverlay(marker);

        // 绘制折线  可以绘制三角形
        var polyline = new BMapGL.Polyline([
            new BMapGL.Point(116.399, 39.910),
            new BMapGL.Point(116.405, 39.920),
            new BMapGL.Point(116.425, 39.900),
            new BMapGL.Point(116.399, 39.910),
        ], { strokeColor: "red", strokeWeight: 6, strokeOpacity: 0.5 });
        map.addOverlay(polyline);

        // 绘制矩形
        var pStart = new BMapGL.Point(116.392214, 39.918985);
        var pEnd = new BMapGL.Point(116.41478, 39.911901);
        var rectangle = new BMapGL.Polygon([
            new BMapGL.Point(pStart.lng, pStart.lat),
            new BMapGL.Point(pEnd.lng, pStart.lat),
            new BMapGL.Point(pEnd.lng, pEnd.lat),
            new BMapGL.Point(pStart.lng, pEnd.lat)
        ], { strokeColor: "blue", strokeWeight: 2, strokeOpacity: 0.5 });  //创建矩形
        map.addOverlay(rectangle);

        // 绘制多边形
        var polygon = new BMapGL.Polygon([
            new BMapGL.Point(116.387112, 39.920977),
            new BMapGL.Point(116.385243, 39.913063),
            new BMapGL.Point(116.394226, 39.917988),
            new BMapGL.Point(116.401772, 39.921364),
            new BMapGL.Point(116.412222, 39.925555),
            new BMapGL.Point(116.41248, 39.927893)
        ], { strokeColor: "blue", strokeWeight: 2, strokeOpacity: 0.5, fillOpacity: 0.5, fillColor: 'red' });  //创建多边形
        map.addOverlay(polygon);

        // 创建圆
        var circle = new BMapGL.Circle(point, 500, { strokeColor: "blue", strokeWeight: 2, strokeOpacity: 0.5 }); //创建圆
        map.addOverlay(circle);

        // 创建点   默认icon是一个旗帜
        var markerPoint = new BMapGL.Marker(new BMapGL.Point(116.404, 39.915), {
            enableDragging: true,
            title: 'hello point'
        });
        map.addOverlay(markerPoint);

        // 创建label
        var label = new BMapGL.Label('学习数据可视化xxxxxx', {
            position: point, // 以point为中心
            offset: new BMapGL.Size(100, 10) // 偏移量
        })
        // 给label 设置样式
        label.setStyle({
            width: '100px',
            height: '20px',
            padding: '20px',
            color: '#fff',
            background: 'red',
            overflow: 'hidden'
        })

        label.addEventListener('click', function (e) {
            alert(e.target.content)
        })

        map.addOverlay(label);
    }

    function loadScript() {
        var script = document.createElement("script");
        script.src = "https://api.map.baidu.com/api?type=webgl&v=1.0&ak=MBABYv1BzdKnzAsynglfLpfDuhCUH3Wv&callback=init"
        document.body.appendChild(script);
    }

    window.onload = loadScript;
</script>

</html>